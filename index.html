<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ShadowSystem Dashboard - Single File</title>
  <style>
    :root{--bg:#08080a;--panel:#0f0f12;--elev:#15151a;--muted:#9aa0a6;--text:#eef0f2;--accent:#ff2d55;--accentd:#d3123a;--radius:14px;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Ubuntu,Cantarell,'Noto Sans',sans-serif;background:radial-gradient(800px 400px at 120% -10%, rgba(255,45,85,0.07), transparent 40%),radial-gradient(700px 360px at -20% 110%, rgba(255,45,85,0.04), transparent 40%),var(--bg);color:var(--text);min-height:100vh}
    .app{display:grid;grid-template-columns:260px 1fr;min-height:100vh}
    .sidebar{background:linear-gradient(180deg, rgba(255,45,85,0.06), transparent),var(--panel);padding:18px;border-right:1px solid rgba(255,255,255,0.03);overflow:auto}
    .brand{display:flex;align-items:center;gap:12px;margin-bottom:10px}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(180deg,var(--accent),var(--accentd));box-shadow:0 6px 20px rgba(0,0,0,0.5)}
    h1{margin:0;font-size:18px}
    .tag{font-size:12px;color:var(--muted)}
    .nav{margin-top:12px;display:flex;flex-direction:column;gap:8px}
    .nav button{background:transparent;border:1px solid transparent;color:var(--text);padding:10px 12px;border-radius:10px;text-align:left;cursor:pointer}
    .nav button.active{background:linear-gradient(90deg, rgba(255,45,85,0.14), transparent);border-color:rgba(255,45,85,0.2)}
    .content{overflow:auto}
    .topbar{position:sticky;top:0;background:linear-gradient(180deg, rgba(15,15,18,0.95), rgba(15,15,18,0.7));padding:12px 18px;border-bottom:1px solid rgba(255,255,255,0.03);display:flex;gap:12px;align-items:center;z-index:4}
    input[type=text],input[type=password],input[type=number],textarea,select{background:var(--elev);border:1px solid rgba(255,255,255,0.04);color:var(--text);padding:10px 12px;border-radius:10px;outline:none;width:100%}
    .btn{background:linear-gradient(180deg,var(--accent),var(--accentd));border:none;color:white;padding:8px 12px;border-radius:10px;cursor:pointer}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}
    .btn.small{padding:6px 10px;font-size:13px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:14px;padding:18px}
    .card{grid-column:span 12;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent),var(--panel);border-radius:var(--radius);padding:16px;border:1px solid rgba(255,255,255,0.03)}
    .cols-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .label{font-size:12px;color:var(--muted);margin-bottom:6px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid rgba(255,255,255,0.03);text-align:left}
    th{color:var(--muted)}
    .footer{padding:14px 18px;color:var(--muted)}
    .small-muted{font-size:12px;color:var(--muted)}
    @media(max-width:960px){.app{grid-template-columns:1fr}.sidebar{position:sticky;top:0}}    
  </style>
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo" aria-hidden></div>
        <div>
          <h1>ShadowSystem</h1>
          <div class="tag">Single-file Dashboard (demo)</div>
        </div>
      </div>

      <div class="nav" id="nav"></div>
      <div style="height:12px"></div>
      <div class="small-muted">Warning: this single-file demo **does not** connect to Discord. Do NOT paste real bot tokens here. Use the backend variant for real bots.</div>
    </aside>

    <main class="content">
      <div class="topbar">
        <div style="display:flex;gap:12px;align-items:center;width:100%">
          <input id="serverId" type="text" placeholder="Workspace / Server ID" style="max-width:260px" />
          <button class="btn small" id="loadServer">Load</button>
          <button class="btn small ghost" id="newServer">New</button>
        </div>
        <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
          <input id="adminUnlock" type="password" placeholder="Enter admin code to unlock" style="width:260px" />
          <button class="btn small" id="unlockBtn">Unlock</button>
          <button class="btn small ghost" id="exportBtn">Export</button>
          <label class="btn small ghost" for="importFile">Import<input id="importFile" type="file" accept="application/json" style="display:none"></label>
        </div>
      </div>

      <div class="grid" id="view"></div>
      <div class="footer">ShadowSystem single‑file demo • Local-only (localStorage). Real bot control requires a backend server for security.</div>
    </main>
  </div>

<script>
// ShadowSystem - Single file dashboard (demo)
// NOTE: This demo is client-only. It simulates bots and stores everything locally.
// DO NOT paste real Discord bot tokens here. This demo will store whatever you enter in localStorage unencrypted.

const STORAGE_KEY = 'shadowsystem_v2';
const ADMIN_CODE = 'shadowmcontop123'; // unlock code

const SECTIONS = [
  {id:'overview', label:'Overview'},
  {id:'welcome', label:'Welcome'},
  {id:'autoresponder', label:'Auto Responder'},
  {id:'moderation', label:'Moderation'},
  {id:'tickets', label:'Tickets'},
  {id:'currency', label:'Currency'},
  {id:'logging', label:'Logging'},
  {id:'admin', label:'Admin'}
];

let db = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
let current = 'overview';
let currentWorkspace = 'default';
let adminUnlocked = false;
let activeBotKey = null; // reference to a stored bot (not real token)

function defaults(){
  return {
    meta:{name:currentWorkspace, created:Date.now()},
    bots:{}, // keyed by botKey
    settings:{
      welcome:{enabled:true,channel:'#welcome',message:'Welcome {user} to {server}!'},
      autoresponder:{enabled:true,entries:[]},
      moderation:{antispam:true,antilinks:true,badwords:[]},
      tickets:{enabled:true,list:[]},
      currency:{enabled:true,symbol:'⛃',users:[]},
      logging:{join:true,leave:true}
    }
  }
}

function ensureWorkspace(id){
  if(!db[id]){ db[id]=defaults(); db[id].meta.name = id; save(); }
  return db[id];
}

function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(db)); }

// UI setup
const navEl = document.getElementById('nav');
const viewEl = document.getElementById('view');

function renderNav(){
  navEl.innerHTML='';
  SECTIONS.forEach(s=>{
    const btn = document.createElement('button'); btn.textContent = s.label; btn.className = (current===s.id)?'active':''; btn.onclick = ()=>{ current = s.id; renderNav(); renderView(); };
    navEl.appendChild(btn);
  })
}

function $(html){ const t = document.createElement('template'); t.innerHTML = html.trim(); return t.content.firstElementChild; }

function flash(msg){ const n=document.createElement('div'); n.textContent=msg; n.style.cssText='position:fixed;right:18px;bottom:18px;background:linear-gradient(90deg,var(--accent),var(--accentd));color:#fff;padding:10px 12px;border-radius:10px;z-index:9999'; document.body.appendChild(n); setTimeout(()=>n.remove(),1800); }

function botListHTML(ws){
  const bots = Object.values(ws.bots || {});
  if(bots.length===0) return '<div class="small-muted">No bots registered yet.</div>';
  return `<table><thead><tr><th>Name</th><th>Key</th><th>Status</th><th style="width:220px">Actions</th></tr></thead><tbody>` +
    bots.map(b=>`<tr><td>${escapeHtml(b.name)}</td><td>${b.key}</td><td>${b.running?'<span style="color:#7fffd4">ON</span>':'<span style="color:#f6b26b">OFF</span>'}</td><td><button class="btn small" data-act="select" data-key="${b.key}">Select</button> <button class="btn small ghost" data-act="toggle" data-key="${b.key}">${b.running?'Stop':'Start'}</button> <button class="btn small ghost" data-act="remove" data-key="${b.key}">Remove</button></td></tr>`).join('') + '</tbody></table>'
}

function renderView(){
  const ws = ensureWorkspace(currentWorkspace);
  viewEl.innerHTML = '';
  // Overview
  if(current==='overview'){
    viewEl.appendChild($(/*html*/`
      <div class="card"><h2>Overview</h2><p class="small-muted">Workspace: <strong>${escapeHtml(currentWorkspace)}</strong> • Created: ${new Date(ws.meta.created).toLocaleString()}</p>
      <div style="margin-top:12px">${ws.settings.welcome.enabled?'<span style="padding:6px;border-radius:8px;background:rgba(255,255,255,0.02);margin-right:6px">Welcome ON</span>':''}${ws.settings.autoresponder.enabled?'<span style="padding:6px;border-radius:8px;background:rgba(255,255,255,0.02);margin-right:6px">AutoResponder ON</span>':''}${ws.settings.tickets.enabled?'<span style="padding:6px;border-radius:8px;background:rgba(255,255,255,0.02)">Tickets ON</span>':''}</div>
      <div style="margin-top:12px">${botListHTML(ws)}</div>
      </div>
    `));
  }

  if(current==='welcome'){
    viewEl.appendChild($(/*html*/`
      <div class="card"><h2>Welcome</h2>
        <div class="cols-2">
          <div>
            <div class="label">Enabled</div>
            <select id="wel_enabled"><option value="true">True</option><option value="false">False</option></select>
            <div class="label">Channel</div>
            <input id="wel_channel" type="text" />
          </div>
          <div>
            <div class="label">Message</div>
            <textarea id="wel_msg" rows="6"></textarea>
            <div style="margin-top:8px"><button class="btn" id="wel_save">Save</button></div>
          </div>
        </div>
      </div>
    `));
    document.getElementById('wel_enabled').value = String(ws.settings.welcome.enabled);
    document.getElementById('wel_channel').value = ws.settings.welcome.channel;
    document.getElementById('wel_msg').value = ws.settings.welcome.message;
    document.getElementById('wel_save').onclick = ()=>{ ws.settings.welcome.enabled = document.getElementById('wel_enabled').value==='true'; ws.settings.welcome.channel = document.getElementById('wel_channel').value; ws.settings.welcome.message = document.getElementById('wel_msg').value; save(); flash('Saved'); }
  }

  if(current==='autoresponder'){
    viewEl.appendChild($(/*html*/`
      <div class="card"><h2>Auto Responder</h2>
        <div class="row" style="gap:8px;display:flex;margin-bottom:8px"><input id="ar_trig" type="text" placeholder="trigger" style="max-width:200px"><input id="ar_resp" type="text" placeholder="response" style="flex:1"><button class="btn" id="ar_add">Add</button></div>
        <div id="ar_list"></div>
      </div>
    `));
    const list = document.getElementById('ar_list');
    function redraw(){ list.innerHTML = '';
      ws.settings.autoresponder.entries.forEach((e,i)=>{ const row = document.createElement('div'); row.style.display='flex'; row.style.gap='8px'; row.style.marginBottom='6px'; row.innerHTML = `<div style="flex:1">${escapeHtml(e.trigger)}</div><div style="flex:3">${escapeHtml(e.response)}</div><div style="width:140px"><button class="btn small" data-i="${i}">Delete</button></div>`; list.appendChild(row); row.querySelector('button').onclick = ()=>{ ws.settings.autoresponder.entries.splice(i,1); save(); redraw(); } }); }
    redraw();
    document.getElementById('ar_add').onclick = ()=>{ const t=document.getElementById('ar_trig').value.trim(); const r=document.getElementById('ar_resp').value.trim(); if(!t||!r) return flash('Fill fields'); ws.settings.autoresponder.entries.push({trigger:t,response:r}); save(); redraw(); document.getElementById('ar_trig').value=''; document.getElementById('ar_resp').value=''; }
  }

  if(current==='moderation'){
    viewEl.appendChild($(/*html*/`
      <div class="card"><h2>Moderation</h2>
        <div class="cols-2"><div><div class="label">Anti-spam</div><select id="m_spam"><option>true</option><option>false</option></select><div class="label">Anti-links</div><select id="m_links"><option>true</option><option>false</option></select></div><div><div class="label">Bad words (comma)</div><input id="m_bad" type="text"><div style="margin-top:8px"><button class="btn" id="m_save">Save</button></div></div></div></div>
    `));
    document.getElementById('m_spam').value = String(ws.settings.moderation.antispam);
    document.getElementById('m_links').value = String(ws.settings.moderation.antilinks);
    document.getElementById('m_bad').value = ws.settings.moderation.badwords.join(',');
    document.getElementById('m_save').onclick = ()=>{ ws.settings.moderation.antispam = document.getElementById('m_spam').value==='true'; ws.settings.moderation.antilinks = document.getElementById('m_links').value==='true'; ws.settings.moderation.badwords = document.getElementById('m_bad').value.split(',').map(x=>x.trim()).filter(Boolean); save(); flash('Saved'); }
  }

  if(current==='tickets'){
    viewEl.appendChild($(/*html*/`
      <div class="card"><h2>Tickets</h2>
        <div style="display:flex;gap:8px;margin-bottom:8px"><input id="tk_title" type="text" placeholder="Issue title" style="flex:1"><button class="btn" id="tk_new">New Ticket</button></div>
        <div id="tk_list"></div>
      </div>
    `));
    function drawTickets(){ const el = document.getElementById('tk_list'); el.innerHTML=''; ws.settings.tickets.list.forEach((t,i)=>{ const d=document.createElement('div'); d.style.display='flex'; d.style.gap='8px'; d.style.marginBottom='6px'; d.innerHTML=`<div style="width:40px">#${t.id}</div><div style="flex:1">${escapeHtml(t.title)}</div><div style="width:120px">${t.status}</div><div style="width:220px"><button class="btn small" data-i="${i}">Close</button> <button class="btn small ghost" data-i2="${i}">Delete</button></div>`; el.appendChild(d); d.querySelector('[data-i]')?.addEventListener('click', ()=>{ t.status='Closed'; save(); drawTickets(); }); d.querySelector('[data-i2]')?.addEventListener('click', ()=>{ ws.settings.tickets.list.splice(i,1); save(); drawTickets(); }); }); }
    drawTickets();
    document.getElementById('tk_new').onclick = ()=>{ const title=document.getElementById('tk_title').value.trim(); if(!title) return flash('Enter title'); const id=(ws.settings.tickets.list.at(-1)?.id||0)+1; ws.settings.tickets.list.push({id,title,status:'Open',created:Date.now()}); save(); drawTickets(); document.getElementById('tk_title').value=''; }
  }

  if(current==='currency'){
    viewEl.appendChild($(/*html*/`
      <div class="card"><h2>Currency</h2>
        <div style="display:flex;gap:8px;margin-bottom:8px"><input id="cu_name" type="text" placeholder="User name"><input id="cu_amount" type="number" placeholder="Amount" style="width:120px"><button class="btn" id="cu_add">Add</button></div>
        <div id="cu_table"></div>
      </div>
    `));
    function drawC(){ const el=document.getElementById('cu_table'); el.innerHTML=''; const list = ws.settings.currency.users.slice().sort((a,b)=>b.balance-a.balance); list.forEach(u=>{ const r=document.createElement('div'); r.style.display='flex'; r.style.gap='8px'; r.style.marginBottom='6px'; r.innerHTML=`<div style="flex:1">${escapeHtml(u.name)}</div><div style="width:120px">${ws.settings.currency.symbol}${u.balance}</div><div style="width:140px"><button class="btn small" data-name="${escapeHtml(u.name)}">Reset</button></div>`; el.appendChild(r); r.querySelector('button').onclick = ()=>{ u.balance=0; save(); drawC(); } }); }
    drawC();
    document.getElementById('cu_add').onclick = ()=>{ const name=document.getElementById('cu_name').value.trim(); const amt=Number(document.getElementById('cu_amount').value||0); if(!name||!amt) return flash('Fill fields'); let u = ws.settings.currency.users.find(x=>x.name.toLowerCase()===name.toLowerCase()); if(!u){ u={name, balance:0}; ws.settings.currency.users.push(u); } u.balance += amt; save(); drawC(); }
  }

  if(current==='logging'){
    viewEl.appendChild($(/*html*/`
      <div class="card"><h2>Logging</h2>
        <div class="cols-2"><div><div class="label">Join logs</div><select id="lg_join"><option>true</option><option>false</option></select></div><div><div class="label">Leave logs</div><select id="lg_leave"><option>true</option><option>false</option></select></div></div>
        <div style="margin-top:8px"><button class="btn" id="lg_save">Save</button></div>
      </div>
    `));
    document.getElementById('lg_join').value = String(ws.settings.logging.join);
    document.getElementById('lg_leave').value = String(ws.settings.logging.leave);
    document.getElementById('lg_save').onclick = ()=>{ ws.settings.logging.join = document.getElementById('lg_join').value==='true'; ws.settings.logging.leave = document.getElementById('lg_leave').value==='true'; save(); flash('Saved'); }
  }

  if(current==='admin'){
    // Admin panel: requires unlock to manage bots
    viewEl.appendChild($(/*html*/`
      <div class="card"><h2>Admin</h2>
        <p class="small-muted">Register bots (simulated). <strong>Do NOT paste real Discord tokens here.</strong></p>
        <div style="display:flex;gap:8px;margin-bottom:8px"><input id="bot_name" type="text" placeholder="Bot display name" style="max-width:240px"><input id="bot_token" type="text" placeholder="BOT_TOKEN (demo)" style="flex:1"><button class="btn" id="bot_register">Register Bot</button></div>
        <div id="bot_list_container"></div>
        <div style="margin-top:12px"><button class="btn ghost" id="bot_apply">Apply settings to selected bot</button> <button class="btn ghost" id="reset_ws">Reset Workspace</button></div>
      </div>
    `));

    const blc = document.getElementById('bot_list_container');
    function redrawBots(){ blc.innerHTML = ''; blc.innerHTML = botListHTML(ws); Array.from(blc.querySelectorAll('[data-act]')).forEach(btn=>{ btn.onclick = onBotAction; }); }
    redrawBots();

    document.getElementById('bot_register').onclick = ()=>{
      if(!adminUnlocked) return alert('Unlock admin first with the admin code.');
      const name = document.getElementById('bot_name').value.trim() || 'Unnamed';
      const token = document.getElementById('bot_token').value.trim() || ('demo-token-'+Date.now());
      // We will not use real tokens. Instead we store a safe bot key derived from token for identification.
      const key = 'bot_'+Math.random().toString(36).slice(2,10);
      ws.bots[key] = {name, key, token_preview: token.slice(0,6)+'...','running':false}; save(); redrawBots(); flash('Bot registered (simulated)'); document.getElementById('bot_name').value=''; document.getElementById('bot_token').value='';
    }

    document.getElementById('bot_apply').onclick = ()=>{
      if(!adminUnlocked) return alert('Unlock admin first.');
      if(!activeBotKey) return alert('Select a bot first');
      // Copy current workspace settings into bot object (simulate deployment)
      ws.bots[activeBotKey].settings = JSON.parse(JSON.stringify(ws.settings)); save(); flash('Settings applied to bot (simulated)');
    }

    document.getElementById('reset_ws').onclick = ()=>{ if(confirm('Reset workspace settings?')){ db[currentWorkspace] = defaults(); save(); renderView(); flash('Workspace reset'); } }
  }
}

function onBotAction(e){ const act = e.currentTarget.dataset.act; const key = e.currentTarget.dataset.key; const ws = ensureWorkspace(currentWorkspace);
  if(act==='select'){ activeBotKey = key; flash('Selected bot: '+(ws.bots[key]?.name||key)); renderView(); }
  if(act==='toggle'){ ws.bots[key].running = !ws.bots[key].running; save(); flash(ws.bots[key].running? 'Bot started (simulated)':'Bot stopped (simulated)'); renderView(); }
  if(act==='remove'){ if(confirm('Remove bot?')){ delete ws.bots[key]; if(activeBotKey===key) activeBotKey=null; save(); renderView(); } }
}

// Topbar actions
document.getElementById('loadServer').onclick = ()=>{ const id = document.getElementById('serverId').value.trim() || 'default'; currentWorkspace = id; ensureWorkspace(id); renderView(); flash('Loaded workspace '+id); }
document.getElementById('newServer').onclick = ()=>{ const id = prompt('New workspace id'); if(!id) return; db[id] = defaults(); db[id].meta.name = id; save(); currentWorkspace=id; document.getElementById('serverId').value=id; renderView(); flash('Created '+id); }

// Unlock admin
document.getElementById('unlockBtn').onclick = ()=>{ const v = document.getElementById('adminUnlock').value.trim(); if(v===ADMIN_CODE){ adminUnlocked = true; flash('Admin unlocked'); renderView(); } else { alert('Wrong code'); } }

// Export/import
function exportAll(){ const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([JSON.stringify(db,null,2)],{type:'application/json'})); a.download='shadowsystem-export.json'; a.click(); }
function handleImport(e){ const f=e.target.files[0]; if(!f) return; const r=new FileReader(); r.onload=()=>{ try{ const data=JSON.parse(r.result); db=data; save(); renderView(); flash('Imported'); }catch(err){ alert('Invalid JSON'); } }; r.readAsText(f); }

document.getElementById('exportBtn').onclick = exportAll; document.getElementById('importFile').onchange = handleImport;

// Helpers
function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"}[c])); }

// init
ensureWorkspace(currentWorkspace); renderNav(); renderView();

</script>
</body>
</html>
